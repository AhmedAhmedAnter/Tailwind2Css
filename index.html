<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI CSS to Tailwind Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      /* Custom scrollbar for webkit browsers */
      textarea::-webkit-scrollbar {
        width: 8px;
      }
      textarea::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 10px;
      }
      textarea::-webkit-scrollbar-thumb {
        background: #94a3b8;
        border-radius: 10px;
      }
      textarea::-webkit-scrollbar-thumb:hover {
        background: #475569;
      }
      .lds-ellipsis {
        display: inline-block;
        position: relative;
        width: 80px;
        height: 80px;
      }
      .lds-ellipsis div {
        position: absolute;
        top: 33px;
        width: 13px;
        height: 13px;
        border-radius: 50%;
        background: #4f46e5;
        animation-timing-function: cubic-bezier(0, 1, 1, 0);
      }
      .lds-ellipsis div:nth-child(1) {
        left: 8px;
        animation: lds-ellipsis1 0.6s infinite;
      }
      .lds-ellipsis div:nth-child(2) {
        left: 8px;
        animation: lds-ellipsis2 0.6s infinite;
      }
      .lds-ellipsis div:nth-child(3) {
        left: 32px;
        animation: lds-ellipsis2 0.6s infinite;
      }
      .lds-ellipsis div:nth-child(4) {
        left: 56px;
        animation: lds-ellipsis3 0.6s infinite;
      }
      @keyframes lds-ellipsis1 {
        0% {
          transform: scale(0);
        }
        100% {
          transform: scale(1);
        }
      }
      @keyframes lds-ellipsis3 {
        0% {
          transform: scale(1);
        }
        100% {
          transform: scale(0);
        }
      }
      @keyframes lds-ellipsis2 {
        0% {
          transform: translate(0, 0);
        }
        100% {
          transform: translate(24px, 0);
        }
      }
    </style>
  </head>
  <body class="bg-slate-100 text-slate-800 antialiased">
    <div class="container mx-auto px-4 py-8 md:py-12">
      <!-- Header -->
      <header class="text-center mb-8 md:mb-12">
        <h1 class="text-3xl md:text-5xl font-bold text-indigo-600">
          Smart CSS to Tailwind Converter
        </h1>
        <p class="mt-2 md:mt-4 text-md md:text-xl text-slate-600">
          Let AI instantly translate your CSS into clean, utility-first Tailwind
          classes.
        </p>
      </header>

      <!-- Main Content -->
      <main>
        <!-- Converter Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
          <!-- CSS Input Card -->
          <div class="bg-white rounded-xl shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4 text-slate-700">
              Your CSS Code
            </h2>
            <textarea
              id="cssInput"
              class="w-full h-80 p-4 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 resize-none bg-slate-50 text-sm"
              placeholder="/* Paste your CSS code here */&#10;&#10;.title {&#10;  font-family: 'cairo', sans-serif;&#10;  font-size: 24px;&#10;  color: #333;&#10;}"
            ></textarea>
          </div>

          <!-- Tailwind Output Card -->
          <div class="bg-white rounded-xl shadow-md p-6 relative">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-xl font-semibold text-slate-700">
                Tailwind CSS Classes
              </h2>
              <button
                id="copyButton"
                title="Copy to Clipboard"
                class="p-2 rounded-md hover:bg-slate-200 text-slate-500 hover:text-indigo-600 transition-colors duration-200"
              >
                <svg
                  id="copyIcon"
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path
                    d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"
                  ></path>
                </svg>
                <svg
                  id="checkIcon"
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="3"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="hidden text-green-500"
                >
                  <path d="M20 6 9 17l-5-5"></path>
                </svg>
              </button>
            </div>
            <div
              id="outputContainer"
              class="w-full h-80 p-4 border border-slate-300 rounded-lg bg-slate-900 text-slate-50 font-mono text-sm overflow-auto"
            >
              <div
                id="loader"
                class="w-full h-full flex-col justify-center items-center hidden"
              >
                <div class="lds-ellipsis">
                  <div></div>
                  <div></div>
                  <div></div>
                  <div></div>
                </div>
                <p class="text-slate-400 mt-4">AI is converting...</p>
              </div>
              <pre
                id="tailwindOutput"
                class="w-full h-full whitespace-pre-wrap"
              ></pre>
            </div>
          </div>
        </div>

        <!-- Action Button -->
        <div class="text-center mt-6 md:mt-8">
          <button
            id="convertButton"
            class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-600 focus:ring-opacity-50 transform hover:scale-105 transition-all duration-200 shadow-lg"
          >
            Convert
          </button>
        </div>

        <!-- Message Box -->
        <div
          id="messageBox"
          class="hidden fixed top-5 right-5 bg-red-500 text-white py-3 px-5 rounded-lg shadow-xl transition-transform transform translate-x-full"
        >
          <p id="messageText"></p>
        </div>
      </main>
    </div>

    <script type="module">
      // --- DOM Element Selection ---
      const convertButton = document.getElementById("convertButton");
      const copyButton = document.getElementById("copyButton");
      const cssInput = document.getElementById("cssInput");
      const tailwindOutput = document.getElementById("tailwindOutput");
      const loader = document.getElementById("loader");
      const outputContainer = document.getElementById("outputContainer");
      const copyIcon = document.getElementById("copyIcon");
      const checkIcon = document.getElementById("checkIcon");
      const messageBox = document.getElementById("messageBox");
      const messageText = document.getElementById("messageText");

      // --- Event Listeners ---
      convertButton.addEventListener("click", handleConversion);
      copyButton.addEventListener("click", copyToClipboard);

      // --- Functions ---

      /**
       * Displays a message to the user.
       * @param {string} message - The message to display.
       * @param {string} type - 'error' or 'success'.
       */
      function showMessage(message, type = "error") {
        messageText.textContent = message;
        messageBox.className = `fixed top-5 right-5 text-white py-3 px-5 rounded-lg shadow-xl transition-transform transform ${
          type === "error" ? "bg-red-500" : "bg-green-500"
        }`;
        messageBox.classList.remove("hidden", "translate-x-full");
        messageBox.classList.add("translate-x-0");
        setTimeout(() => {
          messageBox.classList.remove("translate-x-0");
          messageBox.classList.add("translate-x-full");
        }, 3000);
      }

      /**
       * Handles the click event for the convert button.
       * It retrieves CSS input, validates it, and calls the AI for conversion.
       */
      async function handleConversion() {
        const css = cssInput.value.trim();
        if (!css) {
          showMessage("Please enter some CSS code to convert.");
          return;
        }

        // --- Show loading state ---
        tailwindOutput.classList.add("hidden");
        loader.style.display = "flex";
        convertButton.disabled = true;
        convertButton.textContent = "Converting...";

        try {
          // --- CONSTRUCT THE IMPROVED PROMPT ---
          const prompt = `You are an expert Tailwind CSS developer. Convert the following CSS code into a single line of Tailwind CSS classes.

          **Rules:**
          1.  If a CSS value has a direct mapping to a standard Tailwind class, use the standard class (e.g., 'font-weight: 700;' -> 'font-bold').
          2.  If a CSS value does NOT have a direct mapping, you MUST use Tailwind's arbitrary value syntax. For example:
              - 'color: #0e9d57;' becomes 'text-[#0e9d57]'
              - 'font-size: 15px;' becomes 'text-[15px]'
          3.  If a CSS value uses a 'var()' function with a fallback value, IGNORE the variable name and USE the fallback value for the conversion. For example, 'color: var(--some-var, #374151);' becomes 'text-[#374151]'.
          4.  Completely IGNORE any CSS rule related to 'font-cairo' or 'cairo'. Do not generate any 'font-*' classes for it.
          5.  Do not approximate or find the "nearest" class for custom values. Use the exact value.
          6.  Provide ONLY the final string of class names. Do not include CSS selectors, code blocks (\`\`\`), explanations, or any other text.

          **Example 1 (Custom Color):**
          CSS: color: #12a3b4;
          TAILWIND: text-[#12a3b4]

          **Example 2 (Standard Padding):**
          CSS: padding: 1rem;
          TAILWIND: p-4

          **Example 3 (CSS Variable with Fallback):**
          CSS: background-color: var(--primary, #8a2be2);
          TAILWIND: bg-[#8a2be2]
          
          **Example 4 (Ignoring Font):**
          CSS: font-family: 'cairo', sans-serif; color: #dc2626;
          TAILWIND: text-red-600

          ---
          **CSS CODE TO CONVERT:**
          \`\`\`css
          ${css}
          \`\`\`

          **TAILWIND CLASSES:**`;

          let chatHistory = [];
          chatHistory.push({ role: "user", parts: [{ text: prompt }] });

          const payload = { contents: chatHistory };
          // NOTE: The API key is intentionally left blank. The environment will handle authentication.
          const apiKey = ""; 
          const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

          // Make the API call
          const response = await fetch(apiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          if (!response.ok) {
            throw new Error(
              `API Error: ${response.status} ${response.statusText}`
            );
          }

          const result = await response.json();

          let convertedText = "";
          if (
            result.candidates &&
            result.candidates.length > 0 &&
            result.candidates[0].content &&
            result.candidates[0].content.parts &&
            result.candidates[0].content.parts.length > 0
          ) {
            convertedText = result.candidates[0].content.parts[0].text;
          } else {
            // Handle cases where the response might be blocked or empty
            if (result.promptFeedback && result.promptFeedback.blockReason) {
                 throw new Error(`Request blocked by API: ${result.promptFeedback.blockReason}`);
            }
            throw new Error("Unexpected API response structure.");
          }

          // Clean the response to remove any markdown, extra quotes, or unwanted prefixes.
          const cleanedText = convertedText
            .replace(/```/g, "")
            .replace(/class="/g, "")
            .replace(/"/g, "")
            .replace(/tailwind/g, "")
            .replace(/css/g, "")
            .trim();

          tailwindOutput.textContent = cleanedText;
        } catch (error) {
          console.error("Conversion failed:", error);
          tailwindOutput.textContent =
            "An error occurred. Please check the console for details.";
          showMessage("Failed to convert CSS. Please try again.");
        } finally {
          // --- Hide loading state ---
          loader.style.display = "none";
          tailwindOutput.classList.remove("hidden");
          convertButton.disabled = false;
          convertButton.textContent = "Convert";
        }
      }

      /**
       * Copies the content of the Tailwind output to the clipboard.
       */
      function copyToClipboard() {
        const textToCopy = tailwindOutput.textContent;
        if (!textToCopy) {
          showMessage("Nothing to copy!");
          return;
        }

        // A temporary textarea is used to hold the text for the copy command.
        const tempTextArea = document.createElement("textarea");
        tempTextArea.value = textToCopy;
        document.body.appendChild(tempTextArea);
        tempTextArea.select();

        try {
          // Use document.execCommand as a fallback-safe method for clipboard access in iFrames.
          document.execCommand("copy");

          // Visual feedback for the user
          copyIcon.classList.add("hidden");
          checkIcon.classList.remove("hidden");
          setTimeout(() => {
            copyIcon.classList.remove("hidden");
            checkIcon.classList.add("hidden");
          }, 2000);
        } catch (err) {
          console.error("Failed to copy text: ", err);
          showMessage("Failed to copy text.");
        } finally {
          document.body.removeChild(tempTextArea);
        }
      }
    </script>
  </body>
</html>
